{
  "info": {
    "name": "Test Scripts Collection",
    "description": "Collection for testing JavaScript test scripts",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Status Code Test",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "https://httpbin.org/status/200"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"response is ok\", () =\u003e {",
              "    pm.response.to.have.status(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "JSON Response Test",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "https://httpbin.org/json"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"status code is 200\", () =\u003e {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "const jsonData = pm.response.json();",
              "",
              "pm.test(\"response has slideshow property\", () =\u003e {",
              "    if (!jsonData.slideshow) {",
              "        throw new Error('Missing slideshow property');",
              "    }",
              "});",
              "",
              "pm.test(\"slideshow has author\", () =\u003e {",
              "    if (!jsonData.slideshow.author) {",
              "        throw new Error('Missing author');",
              "    }",
              "});",
              "",
              "pm.collectionVariables.set(\"lastResponse\", responseBody);",
              "pm.collectionVariables.set(\"slideTitle\", jsonData.slideshow.title);"
            ]
          }
        }
      ]
    },
    {
      "name": "Multiple Tests",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "User-Agent",
            "value": "PostOffice"
          }
        ],
        "url": {
          "raw": "https://httpbin.org/get"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"successful GET request\", () =\u003e {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"response has body\", () =\u003e {",
              "    if (responseBody.length === 0) {",
              "        throw new Error(\"Response body is empty\");",
              "    }",
              "});",
              "",
              "pm.environmentVariables.set(\"testToken\", \"abc123\");"
            ]
          }
        }
      ]
    },
    {
      "name": "Failing Test Example",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "https://httpbin.org/status/404"
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"should fail - expects 200 but gets 404\", () =\u003e {",
              "    pm.response.to.have.status(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Pre-Request Script Example",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "X-Custom-Header",
            "value": "{{dynamicValue}}"
          }
        ],
        "url": {
          "raw": "https://httpbin.org/headers"
        }
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.collectionVariables.set('dynamicValue', 'GeneratedValue123');",
              "pm.environmentVariables.set('timestamp', Date.now().toString());"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"status is 200\", () =\u003e {",
              "    pm.response.to.have.status(200);",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Both Pre-Request and Test Scripts",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{authToken}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\"requestId\": \"{{requestId}}\"}"
        },
        "url": {
          "raw": "https://httpbin.org/post"
        }
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.collectionVariables.set('authToken', 'token_' + Date.now());",
              "pm.collectionVariables.set('requestId', 'req_' + Math.random());"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"POST successful\", () =\u003e {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"response has data\", () =\u003e {",
              "    if (responseBody.length === 0) {",
              "        throw new Error('Empty response');",
              "    }",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Variable Getters Demo",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "https://httpbin.org/get"
        }
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.collectionVariables.set('requestTime', Date.now().toString());",
              "pm.environmentVariables.set('envFlag', 'enabled');"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"can get collection variable\", () =\u003e {",
              "    const requestTime = pm.collectionVariables.get('requestTime');",
              "    if (!requestTime) {",
              "        throw new Error('requestTime not found');",
              "    }",
              "});",
              "",
              "pm.test(\"can get environment variable\", () =\u003e {",
              "    const envFlag = pm.environmentVariables.get('envFlag');",
              "    if (envFlag !== 'enabled') {",
              "        throw new Error('Expected enabled, got ' + envFlag);",
              "    }",
              "});",
              "",
              "pm.test(\"pm.variables.get() follows precedence\", () =\u003e {",
              "    const envValue = pm.variables.get('envFlag');",
              "    if (envValue !== 'enabled') {",
              "        throw new Error('Expected env value');",
              "    }",
              "});",
              "",
              "pm.test(\"pm.variables.get() falls back to collection\", () =\u003e {",
              "    const baseUrl = pm.variables.get('baseUrl');",
              "    if (baseUrl !== 'https://httpbin.org') {",
              "        throw new Error('Expected baseUrl from collection');",
              "    }",
              "});",
              "",
              "pm.variables.set('computedValue', 'result_' + Date.now());"
            ]
          }
        }
      ]
    },
    {
      "name": "Full Lifecycle Example (Pre-request + Test + Persistence)",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "https://httpbin.org/uuid"
        }
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.collectionVariables.set('requestTimestamp', Date.now().toString());",
              "pm.collectionVariables.set('requestCounter', (parseInt(pm.collectionVariables.get('requestCounter') || '0') + 1).toString());",
              "pm.environmentVariables.set('lastRequestTime', new Date().toISOString());"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('pre-request variables are available', () =\u003e {",
              "    const timestamp = pm.collectionVariables.get('requestTimestamp');",
              "    const counter = pm.collectionVariables.get('requestCounter');",
              "    if (!timestamp || !counter) {",
              "        throw new Error('Pre-request variables not set');",
              "    }",
              "});",
              "",
              "pm.test('response is valid UUID', () =\u003e {",
              "    const data = pm.response.json();",
              "    if (!data.uuid) {",
              "        throw new Error('No UUID in response');",
              "    }",
              "});",
              "",
              "const responseData = pm.response.json();",
              "pm.collectionVariables.set('lastUUID', responseData.uuid);",
              "pm.environmentVariables.set('uuidCount', (parseInt(pm.environmentVariables.get('uuidCount') || '0') + 1).toString());",
              "",
              "pm.test('variables persist across requests', () =\u003e {",
              "    const counter = parseInt(pm.collectionVariables.get('requestCounter'));",
              "    if (counter \u003c 1) {",
              "        throw new Error('Counter should be at least 1');",
              "    }",
              "});"
            ]
          }
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "https://httpbin.org",
      "type": "string"
    },
    {
      "key": "requestCounter",
      "value": "1",
      "type": "string"
    },
    {
      "key": "requestTime",
      "value": "1767599198541"
    },
    {
      "key": "computedValue",
      "value": "result_1767599198763"
    },
    {
      "key": "requestTimestamp",
      "value": "1766997757382"
    },
    {
      "key": "lastUUID",
      "value": "146a608a-fd30-4d7e-8bfa-1dc151b706f9"
    },
    {
      "key": "lastResponse",
      "value": "{\n  \"slideshow\": {\n    \"author\": \"Yours Truly\", \n    \"date\": \"date of publication\", \n    \"slides\": [\n      {\n        \"title\": \"Wake up to WonderWidgets!\", \n        \"type\": \"all\"\n      }, \n      {\n        \"items\": [\n          \"Why \u003cem\u003eWonderWidgets\u003c/em\u003e are great\", \n          \"Who \u003cem\u003ebuys\u003c/em\u003e WonderWidgets\"\n        ], \n        \"title\": \"Overview\", \n        \"type\": \"all\"\n      }\n    ], \n    \"title\": \"Sample Slide Show\"\n  }\n}\n"
    },
    {
      "key": "slideTitle",
      "value": "Sample Slide Show"
    },
    {
      "key": "authToken",
      "value": "token_1767599180151"
    },
    {
      "key": "requestId",
      "value": "req_0.08778116405236645"
    }
  ]
}